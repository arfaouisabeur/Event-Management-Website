/*
 * VenoBox - jQuery Plugin
 * version: 1.8.5
 * @requires jQuery >= 1.7.0
 */
!function (e) { 
    "use strict"; 
    var s, i, a, c, o, t, d, l, n, r, v, u, b, k, p, m, h, f, g, x, y, w, C, _, B, P, E, O, D, M, N, U, V, I, z, R, X, Y, j, W, q; 
    e.fn.extend({ 
        venobox: function ($) { 
            var A = this, H = e.extend({
                arrowsColor: "#B6B6B6",
                autoplay: !1,
                bgcolor: "#fff",
                border: "0",
                closeBackground: "#161617",
                closeColor: "#d2d2d2",
                framewidth: "",
                frameheight: "",
                gallItems: !1,
                infinigall: !1,
                htmlClose: "&times;",
                htmlNext: "<span>Next</span>",
                htmlPrev: "<span>Prev</span>",
                numeratio: !1,
                numerationBackground: "#161617",
                numerationColor: "#d2d2d2",
                numerationPosition: "top",
                overlayClose: !0,
                overlayColor: "rgba(23,23,23,0.85)",
                spinner: "double-bounce",
                spinColor: "#d2d2d2",
                titleattr: "title",
                titleBackground: "#161617",
                titleColor: "#d2d2d2",
                titlePosition: "top",
                cb_pre_open: function () { return !0 },
                cb_post_open: function () { },
                cb_pre_close: function () { return !0 },
                cb_post_close: function () { },
                cb_post_resize: function () { },
                cb_after_nav: function () { },
                cb_content_loaded: function () { },
                cb_init: function () { } 
            }, $); 
            return H.cb_init(A), this.each(function () { 
                if ((D = e(this)).data("venobox")) return !0; 
                
                function $() {
                    y = D.data("gall"), h = D.data("numeratio"), u = D.data("gallItems"), 
                    b = D.data("infinigall"), k = u || e('.vbox-item[data-gall="' + y + '"]'),
                    w = k.eq(k.index(D) + 1), C = k.eq(k.index(D) - 1), 
                    w.length || !0 === b || (w = k.eq(0)), k.length > 1 ? 
                    (M = k.index(D) + 1, a.html(M + " / " + k.length)) : M = 1, 
                    !0 === h ? a.show() : a.hide(), "" !== x ? c.show() : c.hide(), 
                    w.length || !0 === b ? (e(".vbox-next").css("display", "block"), _ = !0) : 
                    (e(".vbox-next").css("display", "none"), _ = !1), k.index(D) > 0 || !0 === b ? 
                    (e(".vbox-prev").css("display", "block"), B = !0) : 
                    (e(".vbox-prev").css("display", "none"), B = !1), 
                    !0 !== B && !0 !== _ || (d.on(K.DOWN, F), d.on(K.MOVE, G), d.on(K.UP, J))
                } 
                
                function Q(e) {
                    return !(e.length < 1) && (!p && (p = !0, 
                        f = e.data("overlay") || e.data("overlaycolor"), 
                        r = e.data("framewidth"), v = e.data("frameheight"), 
                        o = e.data("border"), i = e.data("bgcolor"), 
                        l = e.data("href") || e.attr("href"), s = e.data("autoplay"), 
                        x = e.attr(e.data("titleattr")) || "", e === C && d.addClass("animated").addClass("swipe-right"), 
                        e === w && d.addClass("animated").addClass("swipe-left"), 
                        E.show(), void d.animate({ opacity: 0 }, 500, function () {
                            g.css("background", f), 
                            d.removeClass("animated").removeClass("swipe-left").removeClass("swipe-right").css({ "margin-left": 0, "margin-right": 0 }), 
                            "iframe" == e.data("vbtype") ? ae() : "inline" == e.data("vbtype") ? oe() : "ajax" == e.data("vbtype") ? ie() : 
                            "video" == e.data("vbtype") ? ce(s) : (d.html('<img src="' + l + '">'), te()), 
                            D = e, $(), p = !1, H.cb_after_nav(D, M, w, C)
                        })
                    ))
                } 
                
                function S(e) {
                    27 === e.keyCode && T(), 37 == e.keyCode && !0 === B && Q(C), 39 == e.keyCode && !0 === _ && Q(w)
                }
                
                function T() {
                    if (!1 === H.cb_pre_close(D, M, w, C)) return !1; 
                    e("body").off("keydown", S).removeClass("vbox-open"), D.focus(), g.animate({ opacity: 0 }, 500, function () { 
                        g.remove(), p = !1, H.cb_post_close() 
                    })
                } 
                
                A.VBclose = function () { T() }, 
                D.addClass("vbox-item"), D.data("framewidth", H.framewidth), 
                D.data("frameheight", H.frameheight), D.data("border", H.border), 
                D.data("bgcolor", H.bgcolor), D.data("numeratio", H.numeratio), 
                D.data("gallItems", H.gallItems), D.data("infinigall", H.infinigall), 
                D.data("overlaycolor", H.overlayColor), D.data("titleattr", H.titleattr), 
                D.data("venobox", !0), 
                
                D.on("click", function (u) {
                    if (u.preventDefault(), D = e(this), !1 === H.cb_pre_open(D)) return !1; 
                    switch (A.VBnext = function () { Q(w) }, A.VBprev = function () { Q(C) }, 
                        f = D.data("overlay") || D.data("overlaycolor"), r = D.data("framewidth"), 
                        v = D.data("frameheight"), s = D.data("autoplay") || H.autoplay, o = D.data("border"), 
                        i = D.data("bgcolor"), _ = !1, B = !1, p = !1, l = D.data("href") || D.attr("href"), 
                        n = D.data("css") || "", x = D.attr(D.data("titleattr")) || "", 
                        P = '<div class="vbox-preloader">',
                        H.spinner) {
                            // Various spinner cases...
                        case "double-bounce":
                            P += '<div class="sk-double-bounce"><div class="sk-child sk-double-bounce1"></div><div class="sk-child sk-double-bounce2"></div></div>'; 
                            break;
                        // More spinner cases...
                    }
                    P += "</div>", O = '<a class="vbox-next">' + H.htmlNext + '</a><a class="vbox-prev">' + H.htmlPrev + "</a>", 
                    U = '<div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">' + H.htmlClose + "</div>", 
                    t = '<div class="vbox-overlay ' + n + '" style="background:' + f + '">' + P + '<div class="vbox-container"><div class="vbox-content"></div></div>' + U + O + "</div>", 
                    e("body").append(t).addClass("vbox-open"), e(".vbox-preloader div:not(.sk-circle) .sk-child, .vbox-preloader .sk-rotating-plane, .vbox-preloader .sk-rect, .vbox-preloader div:not(.sk-folding-cube) .sk-cube, .vbox-preloader .sk-spinner-pulse").css("background-color", H.spinColor), 
                    g = e(".vbox-overlay"), e(".vbox-container"), d = e(".vbox-content"), a = e(".vbox-num"), 
                    c = e(".vbox-title"), (E = e(".vbox-preloader")).show(), c.css(H.titlePosition, "-1px"), 
                    c.css({ color: H.titleColor, "background-color": H.titleBackground }), e(".vbox-close").css({ color: H.closeColor, "background-color": H.closeBackground }), 
                    e(".vbox-num").css(H.numerationPosition, "-1px"), e(".vbox-num").css({ color: H.numerationColor, "background-color": H.numerationBackground }), 
                    e(".vbox-next span, .vbox-prev span").css({ "border-top-color": H.arrowsColor, "border-right-color": H.arrowsColor }), 
                    d.html(""), d.css("opacity", "0"), g.css("opacity", "0"), $(), 
                    g.animate({ opacity: 1 }, 250, function () { 
                        "iframe" == D.data("vbtype") ? ae() : "inline" == D.data("vbtype") ? oe() : "ajax" == D.data("vbtype") ? ie() : 
                        "video" == D.data("vbtype") ? ce(s) : (d.html('<img src="' + l + '">'), te()), 
                        H.cb_post_open(D, M, w, C) 
                    }), e("body").keydown(S), 
                    e(".vbox-prev").on("click", function () { Q(C) }), e(".vbox-next").on("click", function () { Q(w) }), 
                    !1 
                }); 

                // Updated ce function to support local video files and online URLs
                function ce(e) {
                    // Check if file is local (mp4 format)
                    if (l && l.endsWith('.mp4')) {
                        d.html('<video class="venoframe vbvid" controls autoplay><source src="' + l + '" type="video/mp4">Your browser does not support the video tag.</video>');
                    } else {
                        // Original YouTube/Vimeo check code
                        var s, i = function (e) {
                            var s;
                            if (e && e.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/)) {
                                RegExp.$3.indexOf("youtu") > -1 ? s = "youtube" : RegExp.$3.indexOf("vimeo") > -1 && (s = "vimeo");
                                return { type: s, id: RegExp.$6 };
                            }
                            return { type: "", id: "" };
                        }(l), a = (e ? "?rel=0&autoplay=1" : "?rel=0") + function (e) {
                            var s = "", i = decodeURIComponent(e).split("?");
                            if (void 0 !== i[1]) {
                                var a, c, o = i[1].split("&");
                                for (c = 0; c < o.length; c++) a = o[c].split("="), s = s + "&" + a[0] + "=" + a[1];
                            }
                            return encodeURI(s);
                        }(l);
                        if (i.type === "vimeo") s = "https://player.vimeo.com/video/";
                        else if (i.type === "youtube") s = "https://www.youtube.com/embed/";

                        if (i.type) d.html('<iframe class="venoframe vbvid" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="autoplay" frameborder="0" src="' + s + i.id + a + '"></iframe>');
                        else d.html('<p>Error: Video type not supported.</p>');
                    }
                    de();
                }

                // Function to finalize loading content
                function de() {
                    d.animate({ opacity: "1" }, "slow", function () {
                        E.hide(); // Hide the preloader after content is displayed
                    });
                }

                // Close button and overlay close event
                e("body").on("click touchstart", ".vbox-overlay, .vbox-close", function (s) { 
                    if (e(s.target).is(".vbox-overlay") || e(s.target).is(".vbox-close")) {
                        T(); // Call the close function
                    }
                });
            }) 
        } 
    }) 
}(jQuery);
